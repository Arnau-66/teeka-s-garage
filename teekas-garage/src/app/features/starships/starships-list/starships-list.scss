/* ==============================================
   STARSHIPS LIST — HOLO UI (sin cards visibles)
   ============================================== */

/* ---------- Variables ---------- */
:root{
  --c-holo: 72,188,255;         /* azul del glow/haz */
  --holo-text: 72,188,255;      /* azul del título */
  --projector-h: 680px;         /* altura del holoproyector */
}

$rack-gap: .9rem;
$panel-max: 1100px;
$stage-w: clamp(280px, 48vw, 624px);
$stage-h: clamp(160px, 24vh, 280px);

/* ---------- Base ---------- */
.hangar{ position:relative; min-height:100dvh; padding:2rem 0; overflow:hidden; }
.hangar__bg{ position:absolute; inset:0; z-index:0; background:url('/img/garage-background.png') center/cover no-repeat; }
.hangar__stars{ position:absolute; inset:0; z-index:1; pointer-events:none; opacity:.25;
  background-size: 500px 500px, 800px 800px; background-position: 0 0, 60px 80px;
}
.hangar__panel{ position:relative; z-index:3; max-width:$panel-max; margin:0 auto; padding:0 1rem;
  padding-bottom: calc(var(--projector-h) + 22vh);
}
.hangar__panel h2{ color:#fff; margin:0 0 .75rem; }

/* ---------- Holograma central (delante del proyector) ---------- */
.holo-stage{
  position: sticky; top: 15%; z-index: 10; /* por DELANTE del proyector */
  display: grid; place-items: center; height: $stage-h; margin-bottom: 1rem; pointer-events: none;
  isolation: isolate; /* necesario para mezclar overlays sin contaminar el resto */
}

/* Imagen con filtros + interferencias (más inestable) */
.holo-stage img{
  display:block; width:$stage-w; height:100%; object-fit:contain;

  /* Filtro SVG + pipeline de color/glow */
  filter:
    url(#holoFX)
    grayscale(1) sepia(1) hue-rotate(170deg) saturate(7) brightness(1.12) contrast(1.18)
    drop-shadow(0 0 16px rgba(var(--c-holo), .95))
    drop-shadow(0 0 34px rgba(var(--c-holo), .55)) !important;

  /* scanlines base */
  mask-image: repeating-linear-gradient(to bottom, rgba(0,0,0,1) 0 2px, rgba(0,0,0,.9) 2px 3px);

  /* MÁS ritmo: combinamos 4 animaciones */
  animation:
    holo-glitch-strong 0.9s steps(16) infinite,
    holo-jitter        2.4s steps(80) infinite,
    holo-hue           9s ease-in-out infinite alternate,
    holo-flicker       0.85s steps(18) infinite;
  will-change: transform, filter, opacity, clip-path;
}

/* Capa superior: scanlines + bandas más vivas */
.holo-stage::before{
  content:"";
  position:absolute; inset:-2px;
  pointer-events:none; mix-blend-mode: screen;
  background:
    repeating-linear-gradient(to bottom, rgba(255,255,255,.08) 0 2px, rgba(0,0,0,0) 2px 4px),
    repeating-linear-gradient(to right , rgba(72,188,255,.08) 0 1px, transparent 1px 3px);
  opacity:.45;
  animation: scan-move 2.8s linear infinite alternate;
  filter: url(#scanlines);
}

/* Capa inferior: halo + grano con “cortes” más frecuentes */
.holo-stage::after{
  content:"";
  position:absolute; inset:-6px; pointer-events:none; z-index:-1;
  background:
    radial-gradient(100% 160% at 50% 0%, rgba(var(--c-holo),.18) 0 50%, transparent 70%),
    repeating-linear-gradient( to bottom, rgba(255,255,255,.06) 0 1px, transparent 1px 3px);
  mix-blend-mode: screen;
  animation:
    holo-glitch-slices 0.95s steps(14) infinite,
    holo-flicker       1.1s steps(14) infinite;
  opacity:.7;
  filter: blur(.25px);
}

.holo-caption{
  font-size: 1.5rem;
  margin-top:.35rem; letter-spacing:.12em; text-transform:uppercase;
  color: rgba(251, 251, 251, 0.9);
  text-shadow: 0 0 10px rgba(var(--holo-text),.95), 0 0 26px rgba(var(--holo-text),.6);
  animation: caption-flicker-strong 2.2s steps(24) infinite;
}

/* Intensifica al hover en desktop */
.holo-stage:hover img{ animation-duration: 0.6s, 1.6s, 7s, 0.6s; }
.holo-stage:hover::after{ animation-duration: 0.7s, 0.8s; opacity:.82; }

/* ---------- Controles (rack oculto) ---------- */
.carousel{
  position: sticky; bottom: calc(var(--projector-h) + 24px);
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: .5rem; z-index: 9;
}

/* Lista funcional pero oculta (sin barra ni elementos visibles) */
.starships.rack.is-hidden{
  height: 0; overflow: hidden; padding: 0; margin: 0;
  position: absolute; left: -9999px; /* fuera de pantalla */
  width: 1px;
}

/* Botones estilo SW */
.sw-btn{
  --edge: rgba(255,255,255,.85);
  --glow: rgba(var(--c-holo), .65);
  appearance:none; border:0; background:transparent; cursor:pointer;
  position:relative; display:inline-grid; place-items:center; padding:0; border-radius:10px; isolation:isolate;
}
.sw-btn__inner{
  padding:.55rem .85rem; border:1.5px solid var(--edge); border-radius:10px;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.18), 0 0 14px var(--glow);
  background: rgba(255,255,255,.06); backdrop-filter: blur(2px);
  display:inline-flex; align-items:center; gap:.45rem;
}
.sw-btn__label{ color:#fff; }
.sw-btn__icon { color:#fff; text-shadow: 0 0 8px rgba(var(--c-holo),.75); font-weight:900;justify-content: center; }
.sw-btn:hover .sw-btn__inner{ box-shadow: inset 0 0 0 1px rgba(255,255,255,.22), 0 0 18px var(--glow); }
.sw-btn[disabled] .sw-btn__inner{ opacity:.45; box-shadow: inset 0 0 0 1px rgba(255,255,255,.12); }
.car-btn{ z-index:9; }
.car-btn .sw-btn__inner{ width:40px; height:40px; padding:0; }

/* ---------- Pager: prev izq, page center, next dcha ---------- */
.pager.bottom{
  position: relative; z-index: 4;
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: .75rem;
  margin-block: .5rem 1rem;
}
.pager__prev{ justify-self: start; }
.pager__next{ justify-self: end; }

/* ---------- Holoproyector (detrás) ---------- */
.holoprojector{
  position: fixed; left: 50%; bottom: -30%; transform: translateX(-50%); display: none !important;
  z-index: 2; display: grid; place-items: center; width: min(1200px, 96vw); pointer-events: none;
}
.holoprojector__img{
  display:block; height: var(--projector-h); width:auto;
  filter: drop-shadow(0 0 16px rgba(var(--c-holo), .8));
}
.holoprojector__beam{
  position:absolute; bottom: calc(var(--projector-h) - 24px); left:50%; transform: translateX(-50%);
  width: 95vw; max-width: 1400px; height: 52vh; z-index: -1; pointer-events:none;
  clip-path: polygon(50% 0%, 12% 100%, 88% 100%);
  background:
    radial-gradient(closest-side, rgba(var(--c-holo), .30), rgba(var(--c-holo), 0) 70%) center top/100% 42% no-repeat,
    linear-gradient(to bottom, rgba(var(--c-holo), .40), rgba(var(--c-holo), .10) 55%, transparent 100%);
  filter: blur(1.4px);
  animation: beam-flicker 1.4s ease-in-out infinite alternate; /* más inestable */
}
@keyframes beam-flicker{ from { opacity:.95; } to { opacity:.55; } }

/* ---------- A11y helper ---------- */
.sr-only{ position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0; }

/* === Place carousel arrows at the edges === */
.carousel{
  display: grid;
  grid-template-columns: 1fr auto 1fr; /* left | spacer | right */
  align-items: center;
}

/* Prev arrow always in the left column */
.car-btn--prev{
  color: #2863e3;
  grid-column: 1 !important;
  justify-self: start;
}

/* Next arrow always in the right column */
.car-btn--next{
  grid-column: 3 !important;
  justify-self: end;
}

/* Keep the (hidden) rack occupying the middle column as a spacer */
.starships.rack.is-hidden{
  position: static;       /* was absolute; let it participate in the grid */
  visibility: hidden;     /* stays invisible */
  height: 0;
  overflow: hidden;
  grid-column: 2;         /* middle column */
  padding: 0; margin: 0;
  width: 100%;
}

/* === Pager: left & right edges (no counter) === */
.pager.bottom{
  display: grid;
  grid-template-columns: 1fr 1fr; /* two columns only */
  align-items: center;
}
.pager__prev{ grid-column: 1; justify-self: start; }
.pager__next{ grid-column: 2; justify-self: end; }

/* Centered action button, above the projector */
.holo-actions{
  position: sticky;
  bottom: calc(var(--projector-h) + 72px); /* súbelo/bájalo si hace falta */
  z-index: 11;                              /* por delante del proyector/haz */
  display: flex;
  justify-content: center;
  pointer-events: auto;
}
.holo-actions .sw-btn__inner{ padding: .7rem 1rem; }

/* Botón bajo el título dentro del holograma */
.holo-stage .holo-actions{
  margin-top: .5rem;
  display: flex;
  justify-content: center;
  pointer-events: auto;
  position: relative;
  z-index: 11;
}
.holo-stage .holo-actions .sw-btn__inner{ padding: .7rem 1rem; }

/* Back-orbit header with two actions at edges */
.back-orbit{
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .75rem;
  margin-bottom: .75rem;
}
.back-orbit .sw-btn__inner{ padding: .55rem .9rem; }
.back-orbit .details-button{ margin-left: auto; }

/* ---------- Keyframes FX holograma (fuertes) ---------- */

/* jitter posicional sutil pero constante */
@keyframes holo-jitter{
  0% { transform: translate(0,0) }
  8% { transform: translate(.3px, -.2px) }
  16%{ transform: translate(-.4px, .2px) }
  24%{ transform: translate(.2px, .1px) }
  32%{ transform: translate(-.3px, -.1px) }
  40%{ transform: translate(.4px, 0) }
  48%{ transform: translate(-.2px, .2px) }
  56%{ transform: translate(.1px, -.2px) }
  64%{ transform: translate(-.3px, .1px) }
  72%{ transform: translate(.2px, 0) }
  80%{ transform: translate(-.2px, .2px) }
  88%{ transform: translate(.3px, -.1px) }
  100%{ transform: translate(0,0) }
}

/* cambios de tono/ganancia algo más acusados */
@keyframes holo-hue{
  0%  { filter: hue-rotate(166deg) saturate(6.6) brightness(1.08) }
  50% { filter: hue-rotate(174deg) saturate(7.8) brightness(1.18) }
  100%{ filter: hue-rotate(170deg) saturate(7.2) brightness(1.12) }
}

/* parpadeo rápido e irregular */
@keyframes holo-flicker{
  0%{opacity:.92} 6%{opacity:.68} 12%{opacity:.98} 18%{opacity:.74}
  26%{opacity:1} 34%{opacity:.7} 41%{opacity:.96} 53%{opacity:.66}
  64%{opacity:.94} 72%{opacity:.62} 83%{opacity:.98} 100%{opacity:.9}
}

/* scanlines moviéndose más */
@keyframes scan-move{
  0%   { transform: translateY(0) }
  100% { transform: translateY(6px) }
}

/* glitch fuerte de la imagen: saltos con skew/scale */
@keyframes holo-glitch-strong{
  0%   { transform: translate3d(0,0,0) skewX(0) scaleX(1); clip-path: inset(0 0 0 0); }
  6%   { transform: translate3d(.6px,0,0) skewX(.4deg) scaleX(1.002); clip-path: inset(1% 0 0 0); }
  12%  { transform: translate3d(-.8px,0,0) skewX(-.6deg) scaleX(.998); clip-path: inset(0 0 2% 0); }
  25%  { transform: translate3d(.4px,0,0) skewX(.2deg) scaleX(1.003); clip-path: inset(3% 0 0 0); }
  37%  { transform: translate3d(-.6px,0,0) skewX(-.5deg) scaleX(.997); clip-path: inset(0 0 4% 0); }
  52%  { transform: translate3d(.5px,0,0) skewX(.3deg) scaleX(1.002); clip-path: inset(2% 0 0 0); }
  68%  { transform: translate3d(-.7px,0,0) skewX(-.7deg) scaleX(.998); clip-path: inset(0 0 3% 0); }
  83%  { transform: translate3d(.8px,0,0) skewX(.8deg) scaleX(1.004); clip-path: inset(1% 0 0 0); }
  100% { transform: translate3d(0,0,0) skewX(0) scaleX(1); clip-path: inset(0 0 0 0); }
}

/* cortes en el overlay (bandas que aparecen/desaparecen) */
@keyframes holo-glitch-slices{
  0%   { clip-path: inset(0 0 0 0); transform: translateX(0) }
  10%  { clip-path: inset(3% 0 0 0); transform: translateX(.6px) }
  22%  { clip-path: inset(0 0 5% 0); transform: translateX(-.7px) }
  35%  { clip-path: inset(2% 0 2% 0); transform: translateX(.3px) }
  49%  { clip-path: inset(0 0 6% 0); transform: translateX(-.5px) }
  63%  { clip-path: inset(4% 0 0 0); transform: translateX(.4px) }
  78%  { clip-path: inset(0 0 4% 0); transform: translateX(-.6px) }
  100% { clip-path: inset(0 0 0 0); transform: translateX(0) }
}

/* caption más nerviosa */
@keyframes caption-flicker-strong{
  0%{opacity:.96} 8%{opacity:.62} 17%{opacity:1} 29%{opacity:.68}
  44%{opacity:.97} 57%{opacity:.6} 76%{opacity:.99} 100%{opacity:.9}
}

/* Respeta reduce-motion */
@media (prefers-reduced-motion: reduce){
  .holo-stage img,
  .holo-stage::before,
  .holo-stage::after,
  .holo-caption { animation: none !important; }
}
