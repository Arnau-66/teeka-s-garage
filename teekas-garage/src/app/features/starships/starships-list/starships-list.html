<section class="starships-list hangar">
  
  <div class="hangar__bg" aria-hidden="true"></div>
  <div class="hangar__stars" aria-hidden="true"></div>

  
  <div class="hangar__scene" aria-hidden="true">
    <div class="jawa"></div>
    <div class="holo-emitter">
      <div class="holo-projection">
        <img
          [src]="currentShipImg || '/img/placeholders/ship-placeholder.png'"
          [attr.alt]="currentShipName ? (currentShipName + ' hologram') : ''"
          decoding="async" />
      </div>
    </div>
  </div>

  <div class="hangar__panel">
    <h2>Starships</h2>

    <div class="back-orbit">
      <a routerLink="/" class="orbit-button" aria-label="Return to orbit">
        ⬅ Back to Orbit
      </a>
    </div>

    @if (loading()) {
         <p aria-live="polite">Loading starships...</p>
    }
    
    @else if (error()) {
        <div class="error" role="alert" aria-live="assertive">
            <p>Ooops! {{ error() }} </p>
            <button type="button" (click)="fetchPage(1)">Retry</button>
        </div>
    }

    @else {
      <div class="carousel">
        
        <button class="car-btn car-btn--prev"
                type="button"
                (click)="goPrevInCarousel()"
                [disabled]="activeIndex() === 0">
          ‹
        </button>
       
        <ul #rack class="starships rack" (mouseleave)="clearPreview()">
          @for (ship of starships(); track ship.url; let i = $index) {
            <li class="starship-item"
                [attr.data-idx]="i"
                [class.is-active]="i === activeIndex()"
                (click)="setActiveIndex(i)"
                (mouseenter)="previewShip(ship, i)"
                (focus)="previewShip(ship, i)"
                tabindex="0">

              <a class="ship-link"
                [routerLink]="['/starships', idFromUrl(ship.url)]"
                aria-label="View details for {{ ship.name }}">
                <span class="duo-line">
                  <strong class="ship-name">{{ ship.name }}</strong>
                  <span class="aurebesh" aria-hidden="true">{{ ship.name }}</span>
                </span>
                <span class="duo-line">
                  <span class="ship-model"> — {{ ship.model }}</span>
                  <span class="aurebesh" aria-hidden="true">— {{ ship.model }}</span>
                </span>
              </a>

            </li>
          } @empty {
            <li class="empty">No starships found.</li>
          }
        </ul>

        <button class="car-btn car-btn--next"
                type="button"
                (click)="goNextInCarousel()"
                [disabled]="activeIndex() >= starships().length - 1">
          ›
        </button>

        <div class="rack-fade rack-fade--left" aria-hidden="true"></div>
        <div class="rack-fade rack-fade--right" aria-hidden="true"></div>
      </div>

      <div class="pager bottom">
        <button type="button" (click)="prevPage()" [disabled]="!hasPrev() || loading()">← Prev</button>
        <span>Page {{ currentPage() }}</span>
        <button type="button" (click)="nextPage()" [disabled]="!hasNext() || loading()">More ships →</button>
      </div>

    }
 
  </div>



</section>